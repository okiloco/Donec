<!DOCTYPE html>
<?php
/**
 * @package     Joomla.Site
 * @subpackage  com_users
 *
 * @copyright   Copyright (C) 2005 - 2014 Open Source Matters, Inc. All rights reserved.
 * @license     GNU General Public License version 2 or later; see LICENSE.txt
 */

defined('_JEXEC') or die;
$base_url=JURI::base();
?>
<!DOCTYPE HTML>
<html manifest="" lang="en-US">
<head>
    <meta charset="UTF-8">
    <title>.:: (1) Personal</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <style type="text/css">
         /**
         * Example of an initial loading indicator.
         * It is recommended to keep this as minimal as possible to provide instant feedback
         * while other resources are still being loaded for the first time
         */
        /*html, body {
            height: 100%;
            background-color: #1985D0
        }*/
        #contenido{
           position: relative;
           padding:20px;
           color:#fff;
        }
        #appLoadingIndicator {
              position: absolute;
              top: 45%;
              width: 100%;
              /*background-color: #FEAFEA;*/
              height: 4em;
           /* -webkit-animation-name: appLoadingIndicator;
            -webkit-animation-duration: 0.5s;
            -webkit-animation-iteration-count: infinite;
            -webkit-animation-direction: linear;*/
        }

        #appLoadingIndicator > * {
            /*background-color: #FFFFFF;*/
            display: inline-block;
           /* height: 30px;
            -webkit-border-radius: 15px;
            margin: 0 5px;
            width: 30px;*/
            opacity: 0.8;
        }

        @-webkit-keyframes appLoadingIndicator{
            0% {
                opacity: 0.8
            }
            50% {
                opacity: 0
            }
            100% {
                opacity: 0.8
            }
        }
        @-webkit-keyframes rotating /* Safari and Chrome */ {
          from {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
          }
          to {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
          }
        }
        @keyframes rotating {
          from {
            -ms-transform: rotate(0deg);
            -moz-transform: rotate(0deg);
            -webkit-transform: rotate(0deg);
            -o-transform: rotate(0deg);
            transform: rotate(0deg);
          }
          to {
            -ms-transform: rotate(360deg);
            -moz-transform: rotate(360deg);
            -webkit-transform: rotate(360deg);
            -o-transform: rotate(360deg);
            transform: rotate(360deg);
          }
        }
        .rotating {
          -webkit-animation: rotating 2s linear infinite;
          -moz-animation: rotating 2s linear infinite;
          -ms-animation: rotating 2s linear infinite;
          -o-animation: rotating 2s linear infinite;
          animation: rotating 2s linear infinite;
        }
        section#player .signal {
          bottom: initial;
          /*top: 25%;
          left: 50%;*/

        }
        .signal {
          position: relative;
          /*top: 50%;*/
          width: 30px;
          left: 45%;

        }
        section#player .signal div {
          min-width: 2em;
          min-height: 2em;
          border-left-color: white;
          border-right-color: white;
        }
        .signal div {
        
          /* top: 50%; */
          /* margin-top: -15px; */
          /* text-align: center; */
          border: 4px solid white;
          display: inline-block;
          min-width: 4em;
          min-height: 4em;
          padding: 0.5em;
          border-radius: 50%;
          border-top-color: transparent;
          border-bottom-color: transparent;
          

          /* margin: 0 auto; */
          

           -webkit-animation-name: appLoadingIndicator;
            -webkit-animation-iteration-count: infinite;
            -webkit-animation: rotating 2s linear infinite;
          -moz-animation: rotating 2s linear infinite;
          -ms-animation: rotating 2s linear infinite;
          -o-animation: rotating 2s linear infinite;
        }
        #contenido{
          min-height:500px;
          background-color: #1985D0;
        }
    </style>
    <!-- <link rel="stylesheet" href="touch-2.4.1/resources/css/sencha-touch.css"> -->
    <!-- <link rel="stylesheet" href="modules/mod_rokfeaturetable/tmpl/css/rokfeaturetable.css"> -->
    <script src="resources/js/jquery.js" type="text/javascript" charset="utf-8"></script>  
  <link rel="stylesheet" href="resources/css/bootstrap.min.css">
  <script src="resources/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="resources/js/underscore.js" type="text/javascript"></script>
    <!-- The line below must be kept intact for Sencha Command to build your application -->
    <script type="text/javascript">BASE_PATH='<?=$base_url;?>'</script> 
   
    
</head>
<body>
  <div id="contenido" class="row">
    
  <div class="col-span-4">
    <div >
      <div id="appLoadingIndicator">
         <div class="signal"><div></div></div>
      </div>
    </div></div>
  <div class="span-3"></div>

   

<script>

  // This is called with the results from from FB.getLoginStatus().
  function statusChangeCallback(response) {
   /* console.log('statusChangeCallback');
    console.log(response);*/
    // The response object is returned with a status field that lets the
    // app know the current login status of the person.
    // Full docs on the response object can be found in the documentation
    // for FB.getLoginStatus().
    if (response.status === 'connected') {
      // Logged into your app and Facebook.
      testAPI();
    } else if (response.status === 'not_authorized') {
      // The person is logged into Facebook, but not your app.
      $('#status').html('Inciar Sesión con Facebook.');
      removePreloading();
    } else {
      // The person is not logged into Facebook, so we're not sure if
      // they are logged into this app or not.
      $('#status').html('Inciar Sesión con Facebook');
      removePreloading();
    }
  }

  // This function is called when someone finishes with the Login
  // Button.  See the onlogin handler attached to it in the sample
  // code below.
  function checkLoginState() {
    FB.getLoginStatus(function(response) {
      statusChangeCallback(response);
    });
  }

  window.fbAsyncInit = function() {
  FB.init({
    appId      : '324631061067127',
    cookie     : true,  // enable cookies to allow the server to access 
                        // the session
    xfbml      : true,  // parse social plugins on this page
    version    : 'v2.2' // use version 2.2
  });

  // Now that we've initialized the JavaScript SDK, we call 
  // FB.getLoginStatus().  This function gets the state of the
  // person visiting this page and can return one of three states to
  // the callback you provide.  They can be:
  //
  // 1. Logged into your app ('connected')
  // 2. Logged into Facebook, but not your app ('not_authorized')
  // 3. Not logged into Facebook and can't tell if they are logged into
  //    your app or not.
  //
  // These three cases are handled in the callback function.

  FB.getLoginStatus(function(response) {
    statusChangeCallback(response);
  });

  };

  // Load the SDK asynchronously
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/sdk.js";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));

  // Here we run a very simple test of the Graph API after login is
  // successful.  See statusChangeCallback() for when this call is made.
  function testAPI() {
  
    console.log('Welcome!  Fetching your information.... ');
    FB.api('/me', function(response) {
      console.log(JSON.stringify(response));
      console.log('Successful login for: ' + response.name);
      $('#status').html(
        'Bienvenido ' + response.name + '!');
      $("#login").css('display','none'); 
      $("#logout").css('display','block');
        
      removePreloading();
    });
  }
  function removePreloading(){
    var signal=$(".signal"),
    contenido=$('#contenido');
   
    signal.slideUp(1000, function() {
      $('html, body').animate({
          scrollTop: $("#contenido").offset().top
      }, 2000); 
      this.remove();
    });       
  }
 

 function login(){
       // alert("??");
    FB.login(function(response) {
      if (response.authResponse) {
         // handle the response
         if (response.status === 'connected') {
           // Logged into your app and Facebook.
           testAPI();
            console.log(response);
         } else if (response.status === 'not_authorized') {
           // The person is logged into Facebook, but not your app.
            $('#status').html('No estás autorizado para esta aplicación.'+response.name);
         } else {
           // The person is not logged into Facebook, so we're not sure if
           // they are logged into this app or not.
            $('#status').html('Inciar Sesión con Facebook.');
         }
       }else{
          alert();
       }
     }, {scope: 'public_profile,email,user_friends'});
  }
  function logOut(){
    FB.logout(function(response) {
        // Person is now logged out
        $("#login").css('display','block'); 
        $("#logout").css('display','none');
        $('#status').html('Inciar Sesión con Facebook');
    });
  }
</script>

<!--
  Below we include the Login Button social plugin. This button uses
  the JavaScript SDK to present a graphical Login button that triggers
  the FB.login() function when clicked.
-->


<!--<fb:login-button scope="public_profile,email" onlogin="checkLoginState();">
</fb:login-button>-->
<!-- <fb:login-button autologoutlink="true" onlogin="onRequestPermission();">
</fb:login-button> -->
<div class="span3"></div>
 <div class="span3">
   <button id="login" onclick="login(); return false;" class="btn btn-success">Iniciar Sesión con Facebook</button>  
   <button id="logout" onclick="logOut()" class="btn btn-primary" style="display:none;">Cerrar Sesión</button>   
 </div>
 <div class="span3"></div> 

<div id="status">
</div>
</body>
</html>